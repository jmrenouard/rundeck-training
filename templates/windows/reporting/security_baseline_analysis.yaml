# L'identifiant unique du job.
- id: "uuid-windows-reporting-security-baseline"
  # Le nom du job.
  name: "Windows - Analyse de la ligne de base de sécurité"
  # La description du job.
  description: "Exécute une analyse de la ligne de base de sécurité à l'aide de l'outil Microsoft Security Compliance Toolkit."
  # Le niveau de log.
  loglevel: INFO
  # Options pour le job.
  options:
    - name: "baseline_path"
      description: "Chemin vers les scripts de la ligne de base de sécurité."
      required: true
      value: "C:\\SecurityBaselines"
    - name: "report_path"
      description: "Chemin pour enregistrer le rapport d'analyse."
      required: true
      value: "C:\\Temp\\security_baseline_report.html"
  # La définition du workflow.
  sequence:
    # Le workflow s'arrête en cas d'échec.
    keepgoing: false
    # Exécution séquentielle.
    strategy: sequential
    # La liste des commandes.
    commands:
      # Étape 1 : Exécuter le script d'analyse de la ligne de base.
      - exec: "powershell -Command \"Import-Module @option.baseline_path@\\BaselineManagement.psd1; Start-SecurityBaselineScan -Path '@option.baseline_path@' -ReportPath '@option.report_path@' -Force\""
        description: "Exécution de l'analyse de la ligne de base de sécurité"
  # Section pour les notifications.
  notification:
    # Notification en cas de succès.
    onsuccess:
      - type: email
        config:
          recipients: "admin@example.com"
          subject: "Rapport d'analyse de la ligne de base de sécurité pour ${node.name}"
          message: "Le rapport d'analyse de la ligne de base de sécurité pour le nœud ${node.name} a été généré avec succès."
    # Notification en cas d'échec.
    onfailure:
      - type: email
        config:
          recipients: "admin@example.com"
          subject: "Échec de l'analyse de la ligne de base de sécurité pour ${node.name}"
          message: "L'analyse de la ligne de base de sécurité pour le nœud ${node.name} a échoué."